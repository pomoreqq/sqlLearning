ğŸ”§ Zadanie 1

Wypisz listÄ™ klientÃ³w, ktÃ³rzy nie zÅ‚oÅ¼yli Å¼adnego zamÃ³wienia.
Masz do dyspozycji tabele:

customers(customer_id, name)

orders(order_id, customer_id)

select c.customer_id, c.name from customers c
left join orders o on c.customer_id = o.customer_id
where o.order_id is null

ğŸš€ Zadanie 2

Wypisz najwyÅ¼szÄ… wartoÅ›Ä‡ zamÃ³wienia dla kaÅ¼dego klienta, ktÃ³ry ma wiÄ™cej niÅ¼ jedno zamÃ³wienie.

Tabele:

orders(order_id, customer_id, total_amount)

select customer_id, count(*), max(total_amount) from orders
group by customer_id
having count(*) > 1


ğŸ”§ Zadanie 3

Wypisz produkty, ktÃ³re nigdy nie zostaÅ‚y zamÃ³wione.

Masz tabele:

products(product_id, product_name)

order_items(order_id, product_id, quantity)

select product_id,product_name from products
where product_id not in (select product_id from order_items)

SELECT ...
FROM products p
WHERE not  EXISTS (
    SELECT 1
    FROM order_items oi
    WHERE oi.product_id = p.product_id
);

ğŸ”§ Zadanie 4: Klienci, ktÃ³rzy zÅ‚oÅ¼yli zamÃ³wienia tylko w ostatnim miesiÄ…cu

Masz tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date)

ğŸ” Twoim celem jest znalezienie tylko tych klientÃ³w, ktÃ³rzy:

majÄ… co najmniej jedno zamÃ³wienie,

ale wszystkie ich zamÃ³wienia byÅ‚y zÅ‚oÅ¼one wyÅ‚Ä…cznie w ostatnim miesiÄ…cu (np. sierpieÅ„ 2025, jeÅ›li dziÅ› mamy 19.08.2025).


SELECT c.customer_id, c.name
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_id, c.name
HAVING 
    MIN(o.order_date) >= '2025-08-01' AND 
    MAX(o.order_date) < '2025-09-01' AND 
    COUNT(*) > 1;
ğŸ”§ Zadanie 5: Aktywni klienci z 3 ostatnich miesiÄ™cy

Masz tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date, status)

ğŸ¯ Twoje zadanie:

Wypisz klientÃ³w, ktÃ³rzy:

mieli co najmniej 2 zamÃ³wienia w ostatnich 3 miesiÄ…cach (czyli od 2025-06-01 do 2025-08-31),

i wszystkie te zamÃ³wienia miaÅ‚y status 'completed'.
SELECT c.customer_id, c.name
FROM customers c
JOIN orders o ON o.customer_id = c.customer_id
WHERE o.status = 'completed'
  AND o.order_date >= '2025-06-01'
  AND o.order_date < '2025-09-01'
GROUP BY c.customer_id, c.name
HAVING COUNT(*) >= 2;

ğŸ”§ Zadanie 6: Klienci tylko z czerwca

Masz tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date, status)

ğŸ¯ Twoje zadanie:

ZnajdÅº klientÃ³w, ktÃ³rzy:

zÅ‚oÅ¼yli dokÅ‚adnie 2 zamÃ³wienia w czerwcu 2025,

i oba zamÃ³wienia miaÅ‚y status 'completed',

nie pokazuj klientÃ³w, ktÃ³rzy mieli inne zamÃ³wienia poza czerwcem lub z innym statusem.'

select c.customer_id, c.name from customers c
join orders o on c.customer_id = o.customer_id
where o.status = 'completed'
AND Month(order_date) = 6 AND year(order_date) = 2025
group by c.customer_id, c.name
having count(*) = 2


Zadanie 7: Najaktywniejsi klienci z jednego miesiÄ…ca

Masz tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date, total_amount, status)

ğŸ¯ Twoje zadanie:

ZnajdÅº klientÃ³w, ktÃ³rzy:

w lipcu 2025 zÅ‚oÅ¼yli zamÃ³wienia na Å‚Ä…cznÄ… wartoÅ›Ä‡ powyÅ¼ej 10 000 (czyli suma total_amount > 10000),

wszystkie ich zamÃ³wienia z tego miesiÄ…ca miaÅ‚y status 'completed',

innych zamÃ³wieÅ„ spoza tego zakresu nie musisz braÄ‡ pod uwagÄ™.
select c.customer_id, c.name from customers c
join orders o on c.customer_id = o.customer_id
where month(order_date) = 7 and year(order_date) = 2025 and o.status = 'completed'
group by c.customer_id, c.name
having sum(o.total_amount) > 10000

ğŸ”§ Zadanie 8: Klienci z wielu zamÃ³wieÅ„ jednego dnia

Masz tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date, status)

ğŸ¯ Twoje zadanie:

ZnajdÅº klientÃ³w, ktÃ³rzy:

w jednym konkretnym dniu zÅ‚oÅ¼yli wiÄ™cej niÅ¼ 2 zamÃ³wienia,

i wszystkie te zamÃ³wienia miaÅ‚y status 'completed'.

ğŸ“Œ Nie chodzi o caÅ‚y miesiÄ…c â€” chodzi o jeden dzieÅ„, jakikolwiek, w ktÃ³rym klient byÅ‚ bardzo aktywny.

select distinct c.customer_id, c.name from customers c
join orders o on c.customer_id = o.customer_id
WHERE o.status = 'completed'
group by c.custoer_id,o.order_date, c.name
having count(*) > 2
âœ… Zadanie 11
ZwrÃ³Ä‡ 3 klientÃ³w z najwyÅ¼szÄ… Å›redniÄ… wartoÅ›ciÄ… zamÃ³wieÅ„
(tylko 'completed'), posortuj malejÄ…co.

Tabele: customers, orders
Kolumny: customer_id, name, total_amount, status

select c.customer_id, c.name, avg(o.total_amount) from c customers
join orders o on c.customer_id = o.customer_id
where status = 'completed'
group by c.customer_id, c.name
order by avg(o.total_amount) desc
limit 3

âœ… Zadanie 13 (wersja krÃ³tka)

ZwrÃ³Ä‡ category, ktÃ³ra:

sprzedaÅ‚a siÄ™ w â‰¥ 3 regionach

i suma amount > 10000

Tabele:

sales(sale_id, product_id, region, amount)

products(product_id, category)

Posortuj po sumie malejÄ…co.

select p.category, sum(s.amount) from products p
join sales s on p.product_id = s.product_id
group by p.category
having count(distinct s.region) >= 3 AND
sum(s.amount) > 10000
order by sum(s.amount) DESC

âœ… Zadanie 14 (krÃ³tkie)

ZwrÃ³Ä‡ klientÃ³w, ktÃ³rzy:

zÅ‚oÅ¼yli zamÃ³wienia tylko w jednym miesiÄ…cu

wszystkie zamÃ³wienia byÅ‚y 'completed'

Tabele:

customers(customer_id, name)

orders(order_id, customer_id, order_date, status)

ZwrÃ³Ä‡: customer_id, name
Sortuj po name.

select c.customer_id, c.name from customers c
join orders o on c.customer_id = o.customer_id
where o.status = 'completed'
group by c.customer_id, c.name
having count(distinct extract(month from order_date)) = 1
order by c.name

ğŸ¯ Zadanie 15 â€“ GROUP BY bez agregatu

Tabele:

employees(employee_id, department, position, salary)

ğŸ‘‰ Polecenie (krÃ³tkie):

ZwrÃ³Ä‡ wszystkie unikalne kombinacje department i position wystÄ™pujÄ…ce w tabeli employees.

UÅ¼yj GROUP BY, ale bez Å¼adnej funkcji agregujÄ…cej.

select deparment,position from employees
group by department,position


ğŸ¯ Zadanie 16 â€“ GROUP BY z aliasem

Tabele:

orders(order_id, customer_id, order_date, total_amount)
select to_char(order_date,'YYYY-MM') as orderDate,sum(total_amount) as sumTotal from orders
group by to_char(order_date,'YYYY-MM')

ğŸ¯ Zadanie 17 â€“ FULL OUTER JOIN

Tabele:

employees(employee_id, name, department_id)

departments(department_id, department_name)
ZwrÃ³Ä‡:

wszystkie pary pracownikÃ³w i nazw dziaÅ‚Ã³w,

nawet jeÅ›li pracownik nie ma przypisanego dziaÅ‚u,

lub dziaÅ‚ nie ma Å¼adnych pracownikÃ³w

SELECT e.employee_id, e.name, d.department_name
FROM employees e
FULL OUTER JOIN departments d ON e.department_id = d.department_id
ORDER BY e.employee_id;
ğŸ¯ Zadanie 18 â€“ JOIN z wykluczeniem (anti-join logic)

Tabele:

products(product_id, product_name)

order_items(order_item_id, product_id)

select p.product_id,p.product_name from p products
left join order_items oi on oi.product_id = p.product_id
where oi.product_id is null
order by p.product_name

ğŸ¯ Zadanie 19 â€“ subquery w SELECT

Tabele:

customers(customer_id, name)

orders(order_id, customer_id, total_amount)

ZwrÃ³Ä‡ listÄ™ klientÃ³w wraz z:

ich name,

oraz Å‚Ä…cznÄ… kwotÄ… wszystkich ich zamÃ³wieÅ„ (jako osobna kolumna).

select c.name, ( select sum(total_amount) from orders o
Where o.customer_id = c.customer_id) as totalSpent
from customers c

ğŸ¯ Zadanie 20 â€“ subquery w WHERE IN (...)

Tabele:

products(product_id, category)

order_items(order_id, product_id)

select product_id,category from products
where product_id in(select product_id from order_items)
order by product_id


ğŸ¯ Zadanie â€“ JOIN z subquery w FROM

Tabele:

customers(customer_id, name)

orders(order_id, customer_id, status, total_amount)

ğŸ‘‰ Polecenie (krÃ³tkie):

ZwrÃ³Ä‡ nazwy klientÃ³w oraz Å›redniÄ… wartoÅ›Ä‡ ich zamÃ³wieÅ„,
ale tylko tych ze statusem 'completed'.

UÅ¼yj podzapytania z agregacjÄ… w FROM, a potem zrÃ³b JOIN z customers.
SELECT 
  c.customer_id,
  c.name,
  o_summary.total
FROM customers c
JOIN (
  SELECT customer_id, SUM(total_amount) AS total
  FROM orders
  WHERE status = 'completed'
  GROUP BY customer_id
) AS o_summary ON c.customer_id = o_summary.customer_id;

